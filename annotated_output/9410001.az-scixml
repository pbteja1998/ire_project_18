CTR	Many of the kinds of language model used in speech understanding suffer from imperfect modeling of intra-sentential contextual influences .	A-0
AIM	I argue that this problem can be addressed by clustering the sentences in a training corpus automatically into subcorpora on the criterion of entropy reduction , and calculating separate language model parameters for each cluster .	A-1
AIM	This kind of clustering offers a way to represent important contextual effects and can therefore significantly improve the performance of a model .	A-2
AIM	It also offers a reasonably automatic means to gather evidence on whether a more complex , context-sensitive model using the same general kind of linguistic information is likely to reward the effort that would be required to develop it : if clustering improves the performance of a model , this proves the existence of further context dependencies , not exploited by the unclustered model .	A-3
OWN	As evidence for these claims , I present results showing that clustering improves some models but not others for the ATIS domain .	A-4
OWN	These results are consistent with other findings for such models , suggesting that the existence or otherwise of an improvement brought about by clustering is indeed a good pointer to whether it is worth developing further the unclustered model .	A-5
BKG	In speech recognition and understanding systems , many kinds of language model may be used to choose between the word and sentence hypotheses for which there is evidence in the acoustic data .	S-0
BKG	Some words , word sequences , syntactic constructions and semantic structures are more likely to occur than others , and the presence of more likely objects in a sentence hypothesis is evidence for the correctness of that hypothesis .	S-1
BKG	Evidence from different knowledge sources can be combined in an attempt to optimize the selection of correct hypotheses,,.	S-2
BKG	Many of the knowledge sources used for this purpose score a sentence hypothesis by calculating a simple , typically linear , combination of scores associated with objects , such as N-grams and grammar rules , that characterize the hypothesis or its preferred linguistic analysis .	S-3
BKG	When these scores are viewed as log probabilities , taking a linear sum corresponds to making an independence assumption that is known to be at best only approximately true , and that may give rise to inaccuracies that reduce the effectiveness of the knowledge source .	S-4
OTH	The most obvious way to make a knowledge source more accurate is to increase the amount of structure or context that it takes account of .	S-5
OTH	For example , a bigram model may be replaced by a trigram one , and the fact that dependencies exist among the likelihoods of occurrence of grammar rules at different locations in a parse tree can be modeled by associating probabilities with states in a parsing table rather than simply with the rules themselves.	S-6
CTR	However , such remedies have their drawbacks .	S-7
CTR	Firstly , even when the context is extended , some important influences may still not be modeled .	S-8
CTR	For example , dependencies between words exist at separations greater than those allowed for by trigrams ( for which long-distance N-gramsare a partial remedy ) , and associating scores with parsing table states may not model all the important correlations between grammar rules .	S-9
CTR	Secondly , extending the model may greatly increase the amount of training data required if sparseness problems are to be kept under control , and additional data may be unavailable or expensive to collect .	S-10
CTR	Thirdly , one cannot always know in advance of doing the work whether extending a model in a particular direction will , in practice , improve results .	S-11
CTR	If it turns out not to , considerable ingenuity and effort may have been wasted .	S-12
AIM	In this paper , I argue for a general method for extending the context-sensitivity of any knowledge source that calculates sentence hypothesis scores as linear combinations of scores for objects .	S-13
BAS	The method , which is related to that of, involves clustering the sentences in the training corpus into a number of subcorpora , each predicting a different probability distribution for linguistic objects .	S-14
OWN	An utterance hypothesis encountered at run time is then treated as if it had been selected from the subpopulation of sentences represented by one of these subcorpora .	S-15
OWN	This technique addresses as follows the three drawbacks just alluded to .	S-16
OWN	Firstly , it is able to capture the most important sentence-internal contextual effects regardless of the complexity of the probabilistic dependencies between the objects involved .	S-17
OWN	Secondly , it makes only modest additional demands on training data .	S-18
OWN	Thirdly , it can be applied in a standard way across knowledge sources for very different kinds of object , and if it does improve on the unclustered model this constitutes proof that additional , as yet unexploited relationships exist between linguistic objects of the type the model is based on , and that therefore it is worth looking for a more specific , more powerful way to model them .	S-19
BKG	The use of corpus clustering often does not boost the power of the knowledge source as much as a specific hand-coded extension .	S-20
BKG	For example , a clustered bigram model will probably not be as powerful as a trigram model .	S-21
OWN	However , clustering can have two important uses .	S-22
OWN	One is that it can provide some improvement to a model even in the absence of the additional ( human or computational ) resources required by a hand-coded extension .	S-23
OWN	The other use is that the existence or otherwise of an improvement brought about by clustering can be a good indicator of whether additional performance can in fact be gained by extending the model by hand without further data collection , with the possibly considerable additional effort that extension would entail .	S-24
OWN	And , of course , there is no reason why clustering should not , where it gives an advantage , also be used in conjunction with extension by hand to produce yet further improvements .	S-25
OWN	As evidence for these claims , I present experimental results showing how , for a particular task and training corpus , clustering produces a sizeable improvement in unigram - and bigram-based models , but not in trigram-based ones ; this is consistent with experience in the speech understanding community that while moving from bigrams to trigrams usually produces a definite payoff , a move from trigrams to 4-grams yields less clear benefits for the domain in question .	S-26
OWN	I also show that , for the same task and corpus , clustering produces improvements when sentences are assessed not according to the words they contain but according to the syntax rules used in their best parse .	S-27
CTR	This work thus goes beyond that ofby focusing on the methodological importance of corpus clustering , rather than just its usefulness in improving overall system performance , and by exploring in detail the way its effectiveness varies along the dimensions of language model type , language model complexity , and number of clusters used .	S-28
CTR	It also differs from's work by clustering at the utterance rather than the paragraph level , and by using a training corpus of thousands , rather than millions , of sentences ; in many speech applications , available training data is likely to be quite limited , and may not always be chunked into paragraphs .	S-29
OTH	Most other work on clustering for language modeling,has addressed the problem of data sparseness by clustering words into classes which are then used to predict smoothed probabilities of occurrence for events which may seldom or never have been observed during training .	S-30
OTH	Thus conceptually at least , their processes are agglomerative : a large initial set of words is clumped into a smaller number of clusters .	S-31
CTR	The approach described here is quite different .	S-32
CTR	Firstly , it involves clustering whole sentences , not words .	S-33
AIM	Secondly , its aim is not to tackle data sparseness by grouping a large number of objects into a smaller number of classes , but to increase the precision of the model by dividing a single object ( the training corpus ) into some larger number of sub-objects ( the clusters of sentences ) .	S-34
OWN	There is no reason why clustering sentences for prediction should not be combined with clustering words to reduce sparseness ; the two operations are orthogonal .	S-35
OWN	Our type of clustering , then , is based on the assumption that the utterances to be modeled , as sampled in a training corpus , fall more or less naturally into some number of clusters so that words or other objects associated with utterances have probability distributions that differ between clusters .	S-36
OWN	Thus rather than estimating the relative likelihood of an utterance interpretation simply by combining fixed probabilities associated with its various characteristics , we view these probabilities as conditioned by the initial choice of a cluster or subpopulation from which the utterance is to be drawn .	S-37
OWN	In both cases , many independence assumptions that are known to be at best reasonable approximations will have to be made .	S-38
OWN	However , if the clustering reflects significant dependencies , some of the worst inaccuracies of these assumptions may be reduced , and system performance may improve as a result .	S-39
OWN	Some domains and tasks lend themselves more obviously to a clustering approach than others .	S-40
OWN	An obvious and trivial case where clustering is likely to be useful is a speech understander for use by travelers in an international airport ; here , an utterance will typically consist of words from one , and only one , natural language , and clusters for different languages will be totally dissimilar .	S-41
OWN	However , clustering may also give us significant leverage in monolingual cases .	S-42
OWN	If the dialogue handling capabilities of a system are relatively rigid , the system may only ask the user a small number of different questions ( modulo the filling of slots with different values ) .	S-43
OTH	For example , the CLARE interface to the Autoroute PC packagehas a fairly simple dialogue model which allows it to ask only a dozen or so different types of question of the user .	S-44
OTH	A Wizard of Oz exercise , carried out to collect data for this task , was conducted in a similarly rigid way ; thus it is straightforward to divide the training corpus into clusters , one cluster for utterances immediately following each kind of system query .	S-45
OTH	Other corpora , such as Wall Street Journal articles , might also be expected to fall naturally into clusters for different subject areas , and indeedreport positive results from corpus clustering here .	S-46
CTR	For some applications , though , there is no obvious extrinsic basis for dividing the training corpus into clusters .	S-47
CTR	The ARPA air travel information ( ATIS ) domain is an example .	S-48
OTH	Questions can mention concepts such as places , times , dates , fares , meals , airlines , plane types and ground transportation , but most utterances mention several of these , and there are few obvious restrictions on which of them can occur in the same utterance .	S-49
OTH	Dialogues between a human and an ATIS database access system are therefore likely to be less clearly structured than in the Autoroute case .	S-50
OWN	However , there is no reason why automatic clustering should not be attempted even when there are no grounds to expect clearly distinct underlying subpopulations to exist .	S-51
OWN	Even a clustering that only partly reflects the underlying variability of the data may give us more accurate predictions of utterance likelihoods .	S-52
OWN	Obviously , the more clusters are assumed , the more likely it is that the increase in the number of parameters to be estimated will lead to worsened rather than improved performance .	S-53
OWN	But this trade-off , and the effectiveness of different clustering algorithms , can be monitored and optimized by applying the resulting cluster-based language models to unseen test data .	S-54
TXT	In Sectionbelow , I report results of such experiments with ATIS data , which , for the reasons given above , would at first sight seem relatively unlikely to yield useful results from a clustering approach .	S-55
TXT	Since , as we will see , clustering does yield benefits in this domain , it seems very plausible that it will also do so for other , more naturally clustered domains .	S-56
OTH	There are many different criteria for quantifying the ( dis ) similarity between ( analyses of ) two sentences or between two clusters of sentences ;provides a good overview .	S-57
CTR	Unfortunately , whatever the criterion selected , it is in general impractical to find the optimal clustering of the data ; instead , one of a variety of algorithms must be used to find a locally optimal solution .	S-58
BKG	Let us for the moment consider the case where the language model consists only of a unigram probability distribution for the words in the vocabulary , with no N-gram ( for N  >  1 ) or fuller linguistic constraints considered .	S-59
OTH	Perhaps the most obvious measure of the similarity between two sentences or clusters is then Jaccard 's coefficient, the ratio of the number of words occurring in both sentences to the number occurring in either or both .	S-60
OTH	Another possibility would be Euclidean distance , with each word in the vocabulary defining a dimension in a vector space .	S-61
CTR	However , it makes sense to choose as a similarity measure the quantity we would like the final clustering arrangement to minimize : the expected entropy ( or , equivalently , perplexity ) of sentences from the domain .	S-62
OWN	This goal is analogous to that used in the work described earlier on finding word classes by clustering .	S-63
OWN	For our simple unigram language model without clustering , the training corpus perplexity is minimized ( and its likelihood is maximized ) by assigning each worda probability, whereis the frequency ofand N is the total size of the corpus .	S-64
OWN	The corpus likelihood is then, and the per-word entropy ,, is thus minimized .	S-65
BAS	( See e.g., chapter 2 for the reasoning behind this ) .	S-66
OWN	If now we model the language as consisting of sentences drawn at random from K different subpopulations , each with its own unigram probability distribution for words , then the estimated corpus probability is	S-67
OWN	where the iterations are over each utterancein the corpus , each clusterfrom whichmight arise , and each wordin utterance.	S-68
OWN	is the likelihood of an utterance arising from cluster ( or subpopulation ), andis the likelihood assigned to wordby cluster k , i.e. its relative frequency in that cluster .	S-69
OWN	Our ideal , then , is the set of clusters that maximizes the cluster-dependent corpus likelihood.	S-70
OWN	As with nearly all clustering problems , finding a global maximum is impractical .	S-71
OWN	To derive a good approximation to it , therefore , we adopt the following algorithm .	S-72
OWN	Select a random ordering of the training corpus , and initialize each cluster, to contain just the kth sentence in the ordering .	S-73
OWN	Present each remaining training corpus sentence in turn , initially creating an additional singleton clusterfor it .	S-74
OWN	Merge that pair of clustersthat entails the least additional cost , i.e. the smallest reduction in the value offor the subcorpus seen so far .	S-75
OWN	When all training utterances have been incorporated , find all the triples, such thatbut the probability of u is maximized by.	S-76
OWN	Move all such u 's ( in parallel ) between clusters .	S-77
OWN	Repeat until no further movements are required .	S-78
OWN	In practice , we keep track not ofbut of the overall corpus entropy.	S-79
OWN	We record the contribution each clustermakes toas	S-80
OWN	whereis the frequency ofinand=, and find the value of this quantity for all possible merged clusters .	S-81
OWN	The merge in the second step of the algorithm is chosen to be the one minimizing the increase in entropy between the unmerged and the merged clusters .	S-82
OWN	The adjustment process in the third step of the algorithm does not attempt directly to decrease entropy but to achieve a clustering with the obviously desirable property that each training sentence is best predicted by the cluster it belongs to rather than by another cluster .	S-83
OWN	This heightens the similarities within clusters and the differences between them .	S-84
OWN	It also reduces the arbitrariness introduced into the clustering process by the order in which the training sentences are presented .	S-85
OWN	The approach is applicable with only a minor modification to N-grams for N  >  1 : the probability of a word within a cluster is conditioned on the occurrence of the N - 1 words preceding it , and the entropy calculations take this into account .	S-86
OWN	Other cases of context dependence modeled by a knowledge source can be handled similarly .	S-87
OWN	And there is no reason why the items characterizing the sentence have to be ( sequences of ) words ; occurrences of grammar rules , either without any context or in the context of , say , the rules occurring just above them in the parse tree , can be treated in just the same way .	S-88
OWN	Experiments were carried out to assess the effectiveness of clustering , and therefore the existence of unexploited contextual dependencies , for instances of two general types of language model .	S-89
OWN	In the first experiment , sentence hypotheses were evaluated on the N-grams of words and word classes they contained .	S-90
OWN	In the second experiment , evaluation was on the basis of grammar rules used rather than word occurrences .	S-91
OWN	In the first experiment , reference versions of a set of 5,873 domain-relevant ( classes A and D ) ATIS - 2 sentences were allocated to K clusters for K = 2 , 3 , 5 , 6 , 10 and 20 for the unigram , bigram and trigram conditions and , for unigrams and bigrams only , K = 40 and 100 as well .	S-92
OWN	Each run was repeated for ten different random orders for presentation of the training data .	S-93
OWN	The unclustered ( K = 1 ) version of each language model was also evaluated .	S-94
OWN	Some words , and some sequences of words such as `` San Francisco '' , were replaced by class names to improve performance .	S-95
OWN	The per-item entropy of the training set ( i.e. the per-word entropy , but ignoring the need to distinguish different words in the same class ) was 6.04 for a unigram language model , 2.96 for bigrams , and 1.97 for trigrams , giving perplexities of 65.7 , 7.76 and 3.92 respectively .	S-96
OWN	The greater the value of K , the more a clustering reduced the apparent training set per-item entropy ( which , of course , is not the same thing as reducing test set entropy ) .	S-97
OWN	The reductions for K = 20 were around 20 % for unigrams , 40 % for bigrams and 50 % for trigrams , with very little variation ( typically 1 % or less ) between different runs for the same condition .	S-98
OWN	The improvement ( if any ) due to clustering was measured by using the various language models to make selections from N-best sentence hypothesis lists ; this choice of test was made for convenience rather than out of any commitment to the N-best paradigm , and the techniques described here could equally well be used with other forms of speech-language interface .	S-99
OWN	Specifically , each clustering was tested against 1,354 hypothesis lists output by a version of the DECIPHER ( TM ) speech recognizerthat itself used a ( rather simpler ) bigram model .	S-100
OWN	Where more then ten hypothesis were output for a sentence , only the top ten were considered .	S-101
OWN	These 1,354 lists were the subset of two 1,000 sentence sets ( the February and November 1992 ATIS evaluation sets ) for which the reference sentence itself occurred in the top ten hypotheses .	S-102
OWN	The clustered language model was used to select the most likely hypothesis from the list without paying any attention either to the score that DECIPHER assigned to each hypothesis on the basis of acoustic information or its own bigram model , or to the ordering of the list .	S-103
OWN	In a real system , the DECIPHER scores would of course be taken into account , but they were ignored here in order to maximize the discriminatory power of the test in the presence of only a few thousand test utterances .	S-104
OWN	To avoid penalizing longer hypotheses , the probabilities assigned to hypotheses were normalized by sentence length .	S-105
OWN	The probability assigned by a cluster to an N-gram was taken to be the simple maximum likelihood ( relative frequency ) value where this was non-zero .	S-106
OWN	When an N-gram in the test data had not been observed at all in the training sentences assigned to a given cluster , a `` failure '' , representing a vanishingly small probability , was assigned .	S-107
CTR	A number of backoff schemes of various degrees of sophistication , including that of, were tried , but none produced any improvement in performance , and several actually worsened it .	S-108
OWN	The average percentages of sentences correctly identified by clusterings for each condition were as given in Table.	S-109
OWN	The maximum possible score was 100 % ; the baseline score , that expected from a random choice of a sentence from each list , was 11.4 .	S-110
OWN	The unigram and bigram scores show a steady and , in fact , statistically significant increase with the number of clusters .	S-111
OWN	Using twenty clusters for bigrams ( score 43.9 % ) in fact gives more than half the advantage over unclustered bigrams that is given by moving from unclustered bigrams to unclustered trigrams .	S-112
OWN	However , clustering trigrams produces no improvement in score ; in fact , it gives a small but statistically significant deterioration , presumably due to the increase in the number of parameters that need to be calculated .	S-113
OWN	The random choice of a presentation order for the data meant that different clusterings were arrived at on each run for a given condition ( ( N , K ) for N-grams and K clusters ) .	S-114
OWN	There was some limited evidence that some clusterings for the same condition were significantly better than others , rather than just happening to perform better on the particular test data used .	S-115
OWN	More trials would be needed to establish whether presentation order does in general make a genuine difference to the quality of a clustering .	S-116
OWN	If there is one , however , it would appear to be fairly small compared to the improvements available ( in the unigram and bigram cases ) from increasing the numbers of clusters .	S-117
BAS	In the second experiment , each training sentence and each test sentence hypothesis was analysed by the Core Language Enginetrained on the ATIS domain.	S-118
OWN	Unanalysable sentences were discarded , as were sentences of over 15 words in length ( the ATIS adaptation had concentrated on sentences of 15 words or under , and analysis of longer sentences was less reliable and slower ) .	S-119
BAS	When a sentence was analysed successfully , several semantic analyses were , in general , created , and a selection was made from among these on the basis of trained preference functions.	S-120
OWN	For the purpose of the experiment , clustering and hypothesis selection were performed on the basis not of the words in a sentence but of the grammar rules used to construct its most preferred analysis .	S-121
OWN	The simplest condition , hereafter referred to as `` 1-rule '' , was analogous to the unigram case for word-based evaluation .	S-122
OWN	A sentence was modeled simply as a bag of rules , and no attempt ( other than the clustering itself ) was made to account for dependencies between rules .	S-123
OWN	Another condition , henceforth `` 2-rule '' because of its analogy to bigrams , was also tried .	S-124
OWN	Here , each rule occurrence was represented not in isolation but in the context of the rule immediately above it in the parse tree ( its `` predecessor '' if the tree is traversed top-down ) .	S-125
OWN	This choice was made on the assumption that the immediately dominating rule would be one important influence on the likelihood of occurrence of a particular rule .	S-126
OTH	Other choices , involving sister rules and / or rules in less closely related positions , or the compilation of rules into common combinationsmight have worked as well or better ; our purpose here is simply to illustrate and assess ways in which explicit context modeling can be combined with clustering .	S-127
OWN	The training corpus consisted of the 4,279 sentences in the 5,873 - sentence set that were analysable and consisted of fifteen words or less .	S-128
OWN	The test corpus consisted of 1,106 hypothesis lists , selected in the same way ( on the basis of length and analysability of their reference sentences ) from the 1,354 used in the first experiment .	S-129
OWN	The `` baseline '' score for this test corpus , expected from a random choice of ( analysable ) hypothesis , was 23.2 % .	S-130
OWN	This was rather higher than the 11.4 % for word-based selection because the hypothesis lists used were in general shorter , unanalysable hypotheses having been excluded .	S-131
OWN	The average percentages of correct hypotheses ( actual word strings , not just the rules used to represent them ) selected by the 1-rule and 2-rule conditions were as given in Table.	S-132
OWN	These results show that clustering gives a significant advantage for both the 1-rule and the 2-rule types of model , and that the more clusters are created , the larger the advantage is , at least up to K = 20 clusters .	S-133
OWN	As with the N-gram experiment , there is weak evidence that some clusterings are genuinely better than others for the same condition .	S-134
AIM	I have suggested that training corpus clustering can be used both to extend the effectiveness of a very general class of language models , and to provide evidence of whether a particular language model could benefit from extending it by hand to allow it to take better account of context .	S-135
OWN	Clustering can be useful even when there is no reason to believe the training corpus naturally divides into any particular number of clusters on any extrinsic grounds .	S-136
OWN	The experimental results presented show that clustering increases the ( absolute ) success rate of unigram and bigram language modeling for a particular ATIS task by up to about 12 % , and that performance improves steadily as the number of clusters climbs towards 100 ( probably a reasonable upper limit , given that there are only a few thousand training sentences ) .	S-137
OWN	However , clusters do not improve trigram modeling at all .	S-138
OWN	This is consistent with experiencethat , for the ATIS domain , trigrams model inter-word effects much better than bigrams do , but that extending the N-gram model beyond N = 3 is much less beneficial .	S-139
OWN	For N-rule modeling , clustering increases the success rate for both N = 1 and N = 2 , although only by about half as much as for N-grams .	S-140
OWN	This suggests that conditioning the occurrence of a grammar rule on the identity of its mother ( as in the 2-rule case ) accounts for some , but not all , of the contextual influences that operate .	S-141
OWN	From this it is sensible to conclude , consistently with the results of, that a more complex model of grammar rule interaction might yield better results .	S-142
OWN	Either conditioning on other parts of the parse tree than the mother node could be included , or a rather different scheme such as Briscoe and Carroll 's could be used .	S-143
OWN	Neither the observation that trigrams may represent the limit of usefulness for N-gram modeling in ATIS , nor that non-trivial contextual influences exist between occurrences of grammar rules , is very novel or remarkable in its own right .	S-144
OWN	Rather , what is of interest is that the improvement ( or otherwise ) in particular language models from the application of clustering is consistent with those observations .	S-145
OWN	This is important evidence for the main hypothesis of this paper : that enhancing a language model with clustering , which once the software is in place can be done largely automatically , can give us important clues about whether it is worth expending research , programming , data-collection and machine resources on hand-coded improvements to the way in which the language model in question models context , or whether those resources are best devoted to different , additional kinds of language model .	S-146
OWN	I am grateful to Manny Rayner and Ian Lewin for useful comments on earlier versions of this paper .	S-147
OWN	Responsibility for any remaining errors or unclarities rests in the customary place .	S-148
OWN	A shorter version of this paper appears in the Proceedings of the ACL Conference on Applied Natural Language Processing , Stuttgart , October 1994 , and is Association for Computational Linguistics .	S-149
